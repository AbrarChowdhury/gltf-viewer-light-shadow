<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Light Shadow</title>
  </head>
  <body>
    <script>
      let directionalLight,
        directionalLight2,
        pointLight1,
        pointLight2,
        spotlight,
        ambient
      let lightShadowMapViewer
      let SCREEN_WIDTH, SCREEN_HEIGHT
      SCREEN_WIDTH = window.innerWidth
      SCREEN_HEIGHT = window.innerHeight
      const FLOOR = -250

      let camera, controls, scene, renderer
      let container, stats

      const fogParams = {
        enableFog: true,
      }
      const NEAR = 10,
        FAR = 3000
      let SHADOW_MAP_WIDTH = 4096,
        SHADOW_MAP_HEIGHT = 4096

      let shadowMap = {
        height: 4096,
        width: 4096,
      }
      let model = null
      let newGltfLoaded = false
      let usingThreeShadow = false
      let modelTransform = {
        scale: 0.5,
        scaleX: 0.5,
        scaleY: 0.5,
        scaleZ: 0.5,
        posX: 0,
        posY: -0.3,
        posZ: 0,
        rotX: 0,
        rotY: 0,
        rotZ: 0,
      }
      let shadowCameraTransform = {
        posX: 0,
        posY: -0.252,
        posZ: 0,
        rotX: Math.PI / 2 ,
        rotY: 0,
        rotZ: 0,
      }
      let shadowCameraHelper
      let mixer

      let showHUD = false
      let middleMouseDown = false
      let useOrbitControls = true

      let animations = []
      let activeAction
      let currentAnimation = ""
      //shader shadow state
      const PLANE_WIDTH = 2.5
      const PLANE_HEIGHT = 2.5
      const Shadow_Source_Height = 5
      const state = {
        shadow: {
          blur: 3.5,
          darkness: 1,
          opacity: 1,
          sourceHeight: Shadow_Source_Height,
        },
      }

      let shadowGroup,
        renderTarget,
        renderTargetBlur,
        shadowCamera,
        cameraHelper,
        depthMaterial,
        horizontalBlurMaterial,
        verticalBlurMaterial
      let plane, blurPlane, fillPlane
    </script>
    <script type="module" src="/main.js"></script>
  </body>
</html>
